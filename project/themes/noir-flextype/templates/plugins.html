{% extends "themes/" ~ registry.get('plugins.site.settings.theme') ~ "/templates/partials/base.html" %}

{% block content %}

{% set name = uri|split('/')|last %}

<div class="container mx-auto bg-white text-black pb-24">
    <div class="pl-6 pr-6 lg:pl-16 lg:pr-16 uppercase text-center pt-24 pb-24 m-0 font-noirpro-semibold">
        <div>
            <h1 class="text-3xl lg:text-6xl mb-0"><a href="{{ url() }}/{{ locale }}/downloads/extend/{{ name }}">{{ entry.title }}</a></h1>
        </div>
        <div>
            <span class="opacity-50"><a href="{{ url() }}/{{ locale }}/downloads">DOWNLOADS</a></span>
            <span class="opacity-50">/</span>
            <span class="opacity-50"><a href="{{ url() }}/{{ locale }}/downloads/extend">EXTEND</a></span>
        </div>
    </div>
    <div class="flex content-center flex-wrap pl-6 pr-6 lg:pl-16 lg:pr-16">
        <div class="w-full lg:w-9/12 pr-2 text-center">
            {% set plugins = entries.fetch('en/downloads/extend/plugins', {}) %}
            {% for plugin in plugins %}
                <a href="{{ url() }}/{{ plugin.slug }}" class="p-6 text-black flex align-middle rounded-lg border-none mb-6 hover:border-none" style="background: #f8f9fb;">
                    <i class="{{ plugin.icon }} text-5xl mr-5"></i>
                    <div class="text-left">
                        <h4 class="text-xl pb-0 mb-0 block">{{ plugin.title }}</h4>
                        <p class="m-0">
                            {{ plugin.description }}
                        </p>
                    </div>
                    {#<p class="mt-6 pb-0 mb-0">
                        <i class="fas fa-user mr-1"></i>
                        <a href="#">Sergey Romanenko</a>

                        <i class="fas fa-tag ml-3 mr-1"></i>
                        {% for tag in plugin.tags|split(',') %}
                            <a href="{{ url() }}/plugins?tag={{ tag }}">{{ tag }}</a>
                        {% endfor %}
                    </p>#}
                </a>
            {% endfor %}
        </div>
        <div class="w-full lg:w-3/12">
            <div class="text-black text-left rounded-lg p-6" style="background: #f8f9fb;">
            {# tags-cloud #}
            {% set tags_cloud = [] %}
            {% for post in entries.fetch('en/downloads/extend/plugins', {
                                                    'where': {
                                                        'key': 'visibility',
                                                        'expr': 'nin',
                                                        'value': ['draft', 'hidden']
                                                    },
                                                    'order_by': {
                                                        'field': 'published_at',
                                                        'direction': 'desc'
                                                    }
                                                }) %}
                {% set tags_cloud = tags_cloud|merge(post.tags|split(',')) %}
            {% endfor %}

            {% if tags_cloud|length > 0 %}
                <h4 class="text-left mb-2">Tags</h4>
                {% for tag in tags_cloud|reduce((unique, item) => item in unique ? unique : unique|merge([item]), [])  %}
                    <a href="{{ url() }}/blog?tag={{ tag }}"><span class="badge badge-primary">{{ tag }}</span></a>
                {% endfor %}
            {% endif %}
            {# /tags-cloud #}
            </div>
            <div class="text-black text-left rounded-lg p-6 mt-6" style="background: #f8f9fb;">
                {% set plugins = [] %}
                {% for plugin in entries.fetch('en/downloads/extend/plugins', {
                                                        'where': {
                                                            'key': 'visibility',
                                                            'expr': 'nin',
                                                            'value': ['draft', 'hidden']
                                                        },
                                                        'order_by': {
                                                            'field': 'published_at',
                                                            'direction': 'desc'
                                                        }
                                                    }) %}
                    {% set plugins = plugins|merge({name:plugin.author_name}) %}
                {% endfor %}

                {% if plugins|length > 0 %}
                    <h4 class="text-left mb-2">Authors</h4>
                    {% for plugin in plugins|reduce((unique, item) => item in unique ? unique : unique|merge([item]), [])  %}
                        <a href="{{ url() }}/blog?tag={{ plugin }}"><span class="badge badge-primary">{{ plugin }}</span></a>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
